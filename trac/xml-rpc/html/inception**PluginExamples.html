<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"><head><title>Tobi Plugin Examples</title></head><body><h1 id="TobiPluginExamples">Tobi Plugin Examples</h1><p>
This page contains descriptions of a series of developer-perspective examples of functionality/features that are added through a plugin/SOA framework. 
</p><p>
We need to aim for plugins being contributed using any of these patterns (in any combination):
</p><dl><dt><strong>Plugins that replace existing functionality</strong></dt><dd>
Example: replace the existing VU-meter
</dd><dt><strong>Plugins that refine existing functionality</strong></dt><dd>
Equals the refinement of an existing plugin.
Example: add a new "merge sections" method to a tree-based TOC Editor plugin
</dd><dt><strong>Plugins that provide entirely new functionality</strong></dt><dd>
Example: add a noise reduction feature to an audio editor
</dd></dl><h2 id="Addingaprojectannotationfeature">Adding a project annotation feature</h2><blockquote>
<p>
<i>The developer will want to:</i>
</p>
</blockquote><ul><li>Introduce "add anotation", "delete anotation" and "view annotation" actions, with activators (buttons) appearing in 1-n already existing(widgets) toolbars/menus;
</li><li>When the add or view actions are invoked, pop a dialog that allows entering textual or audiotorial data;
</li><li>When this dialog is closed, add this as a custom <a href="AnnotationProperty.html" title="">AnnotationProperty?</a> in the SDK tree;
</li><li>Add a view that lists existing annotations and and allows navigating to presentation position, allows removing select annotations;
</li><li>Show existing annotations as lines with a custom color in existing wave form view(s);
</li><li>Add the add/delete/view actions to the context menu of the wave form view;
</li><li>Persist the annotations at save project time;
</li><li>Reinstantiate the annotations at project load time;
</li><li>Add an "Export Annotations as Zed Bookmark File" action appearing in application main menu bar File;
</li></ul><h2 id="Addingaphysical-levelaudiomanipulationfeature">Adding a physical-level audio manipulation feature</h2><p>
(think noise reduction)
</p><blockquote>
<p>
<i>The developer will want to:</i>
</p>
</blockquote><ul><li>Be able to define a wizard, and give access to it in existing menus. Used to noise-reduce sets of files in one batch operation;
</li><li>Get access to current selection in a wave view;
</li><li>Get access to action population of local menus/context menus in relevant views (where a shortcut "noise reduce current selection" appears);
</li><li>Get access to assett management to get/replace wave assets
</li></ul><h2 id="AddingsupportfortheremotecontrolSonyRCS-2mkIII">Adding support for the remote control Sony RCS-2 mkIII</h2><blockquote>
<p>
<i>The developer will want to:</i>
</p>
</blockquote><ul><li>Append a new tab "remote control setup" to the existing configuration dialog;
</li><li>Get read access to application state (recording, playing, paused, etc);
</li><li>Get access to application state modification (start recording, stop recording, play, etc);
</li><li>Get access to presentation (SDK tree navigation) features (next, previous, first, last, ff, rew)
</li></ul><h2 id="AddingsupportforanewSaveAsoption">Adding support for a new Save As option</h2><blockquote>
<p>
<i>The developer will want to:</i>
</p>
</blockquote><ul><li>Append a new Save As XYZ to the existing File menu item in the main application menu;
</li><li>Be able to pop an options dialog/options wizard that is invoked by the save as XYZ action;
</li><li>Get access to the SDK data tree when serializing.
</li></ul><h2 id="Quick-Fix">"Quick-Fix"</h2><p>
We talked about the concept of "intentions" or "quick-fixes", which is a User-Interface design that streamlines the document validation process (in the broader sense, not XML-Schema sense).
</p><p>
So, at authoring time, issues are highlighted inline (i.e. errors/warnings with a red/orange squiggle under a text portion or in the gutter of the text editor), and the user can request an in-context popup menu (or any non-intrusive GUI metaphor) that contains one or more possible fixes (very much like a spell-checker).
</p><p>
Now, this list of proposed fixes is totally extensible via plugins. For example, let's take the following use-case that was recently sent on the Microsoft-Save-As-DAISY-XML internal mailing-list:
</p><blockquote class="citation">
<p>
 The presence of empty p elements may be the intention of the author to
 provide some white space. In addition, when documents are "round tripped" in
 a future release, this white space would be preserved.

 The message surrounding the introduction of empty p elements  between two
 headings of the same level should inform the author that this is normally
 viewed as a authoring error. The introduction of the empty paragraph is to
 permit a successful, valid export.
</p>
</blockquote><p>
Well, in Tobi, we would expose a very simple extension point (i.e. API) for third-party developers, and I think a very simple macro-like language (preferably in declarative XML, like ANT makefiles) to let programmers specify a "quick-fix".
</p><p>
The example mentioned above is about treating empty paragraphs. It's not a validation error per-say, so it's more like a warning for breaking good-practice. Here's how it could look like (without the XML tags):
</p><p>
-- QUICK-FIX --
</p><p>
Title (string):
"Fix empty &lt;p&gt; elements."
</p><p>
Decription (string):
"Proposes alternative content for empty paragraphs."
</p><p>
Type (enum Warning|Error):
"Warning"
</p><p>
Trigger-content (PERL-compatible regular expression):
"&lt;p&gt;[ |\n|\t]*&lt;/p&gt;"
</p><p>
-- Fix<a xmlns="" class="changeset" href="http://daisy-trac.cvsdude.com/tobi/changeset/1" title="- Daniel WECK * The very first commit !! ">[1]</a>
</p><p>
Title (string):
"Delete."
</p><p>
Description (string):
"Removes the empty paragraph."
</p><p>
Action (MACRO):
"clear()"
</p><p>
-- Fix<a xmlns="" class="changeset" href="http://daisy-trac.cvsdude.com/tobi/changeset/2" title="- Daniel WECK * Second commit, to test the mailing-list ">[2]</a>
</p><p>
Title (string):
"Replace with line break."
</p><p>
Description (string):
"Replaces the empty paragraph with a double line break."
</p><p>
Action (MACRO):
"replace_with('&lt;br/&gt;&lt;br/&gt;')"
</p><p>
-- Fix<a xmlns="" class="changeset" href="http://daisy-trac.cvsdude.com/tobi/changeset/3" title="- Daniel WECK * Testing DIFF email message ">[3]</a>
</p><p>
Title (string):
"Replace with horizontal line."
</p><p>
Description (string):
"Replaces the empty paragraph with a horizontal line."
</p><p>
Action (MACRO):
"replace_with('&lt;hr/&gt;')"
</p><hr/><p>
Remarks:
</p><p>
The above fixes are for illustrative purposes only, I have not thought about the DTBook grammar at all.
</p><p>
A nice feature would be to prompt the user with something like "apply to all".
</p><p>
I think that the "Trigger-content" field would better NOT be a regexp. Something like XPath would be much better, especially for context-aware structural issues. Anyway, it's just a proof-of-concept.
</p><p>
I found a pretty good example of a rich application (the generic XML editor "Syntext Serna") which exposes an C++ and Python API for allowing third-party customizations, and of course the definition of plugins.
</p><p>
I have added some screenshots here:
</p><p>
<a href="inception**ExistingSoftware#genericXMLediting:tagsandTOCSyntexSerna.html" title="">http://daisy-trac.cvsdude.com/tobi/wiki/inception/ExistingSoftware#genericXMLediting:tagsandTOCSyntexSerna</a>
</p><p>
It's an interesting example because things are sufficiently simple to be easily documented, and therefore easily adopted by developers:
</p><p>
<a xmlns="" class="ext-link" href="http://docs.syntext.com/sapi_guide/sg.html#phases-plugin-init"><span xmlns="http://www.w3.org/1999/xhtml" class="icon">http://docs.syntext.com/sapi_guide/sg.html#phases-plugin-init</span></a>
</p><p>
<a xmlns="" class="ext-link" href="http://docs.syntext.com/sapi_guide/sg.html#plugin-loading"><span xmlns="http://www.w3.org/1999/xhtml" class="icon">http://docs.syntext.com/sapi_guide/sg.html#plugin-loading</span></a>
</p><p>
The "SPD" format is pretty much what I have in mind when talking about declarative UI (for the simple use-cases, of course. Not for plugins that define or enrich complex graphical user-interfaces):
</p><p>
<a xmlns="" class="ext-link" href="http://docs.syntext.com/sapi_guide/sg.html#hello-spd"><span xmlns="http://www.w3.org/1999/xhtml" class="icon">http://docs.syntext.com/sapi_guide/sg.html#hello-spd</span></a>
</p><p>
<a xmlns="" class="ext-link" href="http://docs.syntext.com/sapi_guide/sg.html#custom-dialog-layout"><span xmlns="http://www.w3.org/1999/xhtml" class="icon">http://docs.syntext.com/sapi_guide/sg.html#custom-dialog-layout</span></a>
</p></body></html>